<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>理财账户</title>
    <link rel="stylesheet" type="text/css" href="{{.Var.static_serve}}/assets/easyui/themes/gray/easyui.css?spam={{.Var.spam}}">
    <link rel="stylesheet" type="text/css" href="{{.Var.static_serve}}/assets/easyui/themes/icon.css?spam={{.Var.spam}}">
    <link href="{{.Var.static_serve}}/assets/mui/css/latest/page_style.css?v={{.Var.version}}" rel="stylesheet" type="text/css" />
    <link href="{{.Var.static_serve}}/css/partner/partner.css?spam={{.Var.spam}}" rel="stylesheet" type="text/css" />
</head>
    <div id="dg"></div>
    <div class="toolBar">
        <div class="search_bar padding2" id="search_bar">
            <ul>
                <li>
                    <span class="title">会员关键字：</span>
                    <input type="text" class="ui-box" field="keyword" placeholder="昵称/用户名/手机" />
                </li>
                <li>
                    <span class="title">排序:</span>
                    <select class="ui-box" field="order">
                            <option value="person_id ASC">默认排序</option>
                            <option value="settlement_amount DESC">按结算金额倒序</option>
                            <option value="balance DESC">按余额倒序</option>
                            <option value="total_amount DESC">按累计转入倒序</option>
                            <option value="total_rise DESC">按累计收益倒序</option>
                        </select>
                    </li>
                </li>
                <li>
                    <a class="easyui-linkbutton" data-options="iconCls:'icon-search'" id="btnSearch">
                        <span class="icon"></span>搜索</a>
                </li>

                <li>
                    <a class="easyui-linkbutton" data-options="iconCls:'icon-ok'" id="btnInfo">
                        <span class="icon"></span>转入/转出记录</a>
                </li>
            </ul>
            <div class="clearfix"></div>
        </div>
        <div class="clearfix"></div>
    </div>


<script type="text/javascript" src="{{.Var.static_serve}}/assets/easyui/jquery.min.js?spam={{.Var.spam}}"></script>
<script type="text/javascript" src="{{.Var.static_serve}}/assets/easyui/jquery.easyui.min.js?spam={{.Var.spam}}"></script>
<script type="text/javascript" src="{{.Var.static_serve}}/assets/easyui/locale/easyui-lang-zh_CN.js?spam={{.Var.spam}}"></script>
<script src="{{.Var.static_serve}}/assets/js/core_full.js?spam={{.Var.spam}}"></script>
<script src="{{.Var.static_serve}}/assets/js/export.js?spam={{.Var.spam}}"></script>
<script src="{{.Var.static_serve}}/assets/js/plugins/sys.js?spam={{.Var.spam}}"></script>

<script type="text/javascript">
    var id = 'dg';
    expr.ele = 'search_bar';
    expr.portal = 'Partner.PersonFinanceRiseAccount';
    expr.checkParams = function (data) {
        return true;
    };

    window.refresh = function () {
        expr.reload(id);
    };

    jr.$(id).style.height = jr.screen.height() + 'px';

    $(function () {

        //导出
        $('#btnExport').click(
                function () {
                    expr.showExportDialog();
                });

        jr.$('btnSearch').onclick=function () {
            expr.search('dg');
        };


        //加载数据
        $('#'+id).datagrid({
            toolbar: '.toolBar',
            singleSelect: !false,
            pagination: true,
            rownumbers: !true,
            fitColumns: true,
            pageList:[30,40,50],
            pageSize:30,
            url: expr.getDataUrl(),
            columns: [
                [
                    //{ field: 'id', title: '编号',align: 'center',width: 60 },

                    { field: 'person_id', title: '编号', width: 80 },
                    { field: 'name', title: '会员', align: 'left', width: 150 },
                    { field: 'balance', title: '余额',align: 'center',width: 100,formatter:roundStr },
                    { field: 'transfer_in', title: '待确认金额',align: 'center',width: 100,formatter:roundStr },
                    { field: 'settlement_amount', title: '结算金额',align: 'center',width: 100 ,formatter:roundStr},
                    { field: 'settled_date', title: '结算日期',align: 'center',width: 100 ,formatter:unix2Date},
                    { field: 'total_amount', title: '累计投入',align: 'center',width: 100,formatter:roundStr },
                    { field: 'total_rise', title: '累计收益',align: 'center',width: 100,formatter:roundStr },
                    {field: 'update_time', title: '更新时间',align: 'center',width:120,formatter:unix2str},
                    {field: 'id1', title: '操作', width: 120, align: 'center',
                    formatter: function (v, r) {
                        return  jr.template('<a href="javascript:;" class="btn btn-short" onclick="showRec(\'{person_id}\')">财务记录</a>',r);
                    }}
                ]
            ]
        });
    });


    function showRec(id){
        jr.tab.open('{{.Map.GrowAlias}}财务详情',location.pathname.substring(0,location.pathname.lastIndexOf("/")+1)+'earnings_log?person_id='+id,
                true);
    }
    $('#btnInfo').click(function(){
        jr.tab.open('{{.Map.GrowAlias}}转入/转出记录',location.pathname.substring(0,location.pathname.lastIndexOf("/")+1)+'earnings_transferlog?person_id='+id,
                true);
    })

</script>

</body>
</html>