<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>请稍后</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="{{.Var.static_serve}}/assets/mui/css/latest/ui_style.css?spam={{.Var.spam}}" />
    <link rel="stylesheet" type="text/css" href="{{.Var.static_serve}}/assets/easyui/themes/gray/easyui.css?spam={{.Var.spam}}" />
    <link rel="stylesheet" type="text/css" href="{{.Var.static_serve}}/assets/easyui/themes/icon.css?spam={{.Var.spam}}" />
    <link type="text/css" rel="stylesheet" href="{{.Var.static_serve}}/css/font/awesome/font.css?spam={{.Var.spam}}"/>
</head>
<body>
<div class="loading-gate hidden"></div>
<div class="loading-bar hidden"><span></span></div>
<div class="page-top">
    <div class="top"></div>
    <div class="logo hidden">
        <img src="{{.Var.static_serve}}/assets/mui/css/latest/logo.png" alt="logo" height="60">
        <div class="licence"><h1 field="sysName">-</h1></div>
    </div>
    <div class="page-user">
        <img field="userAvatar" class="avatar"/>
        <div class="text">
            <span field="dateStr"></span><br/>
            欢迎您：<span class="username" field="userName"></span>&nbsp;&nbsp; |&nbsp;&nbsp;
            <a href="javascript:void(0)" onclick="FwTab.show('修改用户资料', '?module=user&amp;action=saveProfile', true);">修改密码</a>&nbsp;|&nbsp;
            <a href="javascript:;" id="btn_logout" title="安全退出系统">退出</a>
        </div>
    </div>

    <div class="top-ctrl">
        <div class="bg"><span class="lft"></span></div>
        <ul class="icon-ctrl big-nav"></ul>
    </div>


    <div class="clearfix"></div>
</div>

<div class="page-main">
    <div class="page-main-right" id="page-main-right">
        <div id="pagetabs" class="page-tabs">
            <ul> </ul>
            <div class="clearfix"></div>
        </div>
        <div style="height:0px;overflow:hidden;clear:both;display:none;">针对IE7优化</div>
        <div class="page-frames" id="pageframes">
            <div class="mask hidden"></div>
            <div class="loading hidden"><div><span class="lft"><span class="main"><span class="text">加载中 ...</span></span></span></div></div>
            <div class="frames"></div>
            <div class="page-frame-shadow hidden">这是为支持分列右侧拖动</div>
        </div>
    </div>

    <div class="page-main-left" id="page-main-left">
        <div class="page-left-menu">
            <!--
            <div class="title" group="home"><span>车辆管理</span></div>
            <ul class="current">
                <li>
                    <a url="/admin/car/AddCarProfile">
                        车辆录入
                    </a>
                </li>
            </ul>
            <div class="clearfix"></div>-->
        </div>
    </div>

    <div id="page-main-split" class="page-main-split" min="120" max="600"></div>
</div>
<script type="text/javascript"> window._path = location.path;</script>

<script type="text/javascript" src="{{.Var.static_serve}}/assets/js/require.js?spam={{.Var.spam}}"></script>

<script type="text/javascript">
    var pageVar = {
        sysName: '{{.Map.partner.Name}}商户管理中心',
        sysLogo: '',
        dateStr: '2013-10-15',
        firstTabName: '欢迎首页',
        firstIframeUrl: '/main/summary',
        userName: '管理员',
        userAvatar: '{{.Var.static_serve}}/assets/mui/css/latest/avatar.gif'
    };




    var _baseUrl = '{{.Var.static_serve}}';
    require([_baseUrl + "/assets/js/super/require_config.js"], function () {
        require(['jquery.easyui','mui/component'],function(){
            pageVar.dateStr = getDate();
            document.title = '首页-'+pageVar.sysName;
            jr.json.bind(document, pageVar);
            //绑定logo
            var logoEle = document.getElementsByClassName('logo')[0];
            if (pageVar.sysLogo && pageVar.sysLogo.length > 0) {
                logoEle.style.background = 'url(' + pageVar.sysLogo + ')';
            }
            logoEle.className = 'logo';

            //初始化站点
            var timer = setInterval(function () {
                if (window.menuData != null) {
                    clearInterval(timer);
                    FwMenu.init(window.menuData, window.menuHandler);
                    FwMenu.change();
                }
            }, 100);
            FwTab.initialize();
            FwTab.showLoadBar = showGate;
            FwTab.hiddenLoadBar = cancelGate;

            winLoad();
        });
    });


    window.menuHandler = function (data) {
        data.push(
                {id: 'home', text: '首页',class:'fa fa-home',uri: '', childs: [
                    {text: '欢迎使用', uri: '', childs: [
                        {text: '欢迎首页', uri: '/summary'}
                    ]},
                    {text: '销售管理', uri: '', childs: [
                        {text: '分类管理', uri: '/category/all_category'},
                        {text: '商品管理', uri: '/goods/item_list'},
                        {text: '销售标签管理', uri: '/sale/tagList'}
                    ]}
                ]
                });

        data.push({id: 'sales', text: '销售',class:'fa fa-shopping-cart', uri: '', childs: [
            {text: '订单管理', uri: '', childs: [
                {text: '所有订单', uri: '/order/list?status=100'},
                {text: '待确认订单', uri: '/order/list?status=1'},
                {text: '待配送订单', uri: '/order/list?status=2'},
                {text: '待收货订单', uri: '/order/list?status=4'},
                //{text: '待发货订单', uri: '/order/list?status=3'},gof
                //{text: '配送中订单', uri: '/order/list?status=4'},
                //{text: '已收货订单', uri: '/order/list?status=5'},
                {text: '已完成订单', uri: '/order/list?status=6'},
                {text: '已取消订单', uri: '/order/list?status=0'}
            ]},
            {text: '优惠促销', uri: '', childs: [
                {text: '优惠券管理', uri: '/prom/list?flag=1'},
                {text: '商品返现', uri: '/prom/list?flag=2'}
            ]}
        ]});

        data.push({id: 'member', text: '会员',class:'fa fa-user', uri: '', childs: [
            {text: '会员管理', uri: '', childs: [
                {text: '会员等级管理', uri: '/member/levelList'},
                {text: '会员列表', uri: '/member/list'},
                {text: '会员推广排行', uri: '/member/team_rank'},
            ]}
        ]});

        data.push({id: 'finance', text: '财务',class:'fa fa-money', uri: '', childs: [
            {text: '财务管理', uri: '', childs: [
                {text: '订单付款', uri: '/order/waitPaymentList'},
                {text: '提现申请', uri: '/member/applyRequestList'},
                {text: '{{.Map.AliasGrow}}', uri: '/person_finance/earnings_account'},
            ]},
        ]});


        data.push({id: 'merchant', text: '商户',class:'fa fa-diamond', uri: '', childs: [
            {text: 'O2O配置', uri: '', childs: [
                {text: '门店管理', uri: '/shop/ShopList'},
                {text: '配送区域', uri: '/delivery/CoverageAreList'},
            ]},
        ]});

        data.push({id: 'content', text: '内容',class:'fa fa-file-text', uri: '', childs: [
            {text: '内容管理', uri: '', childs: [
                {text: '页面管理', uri: '/content/page_list'},
                {text: '广告管理', uri: '/ad/list'}
            ]}
        ]});

        data.push({id: 'config', text: '设置',class:'fa fa-cogs', uri: '', childs: [
            {text: '商家设置', uri: '', childs: [
                {text: '资料修改', uri: '/conf/profile'},
                {text: '站点设置', uri: '/conf/siteConf'},
                {text: '销售设置', uri: '/conf/saleConf'}
            ]},
            {text: '消息系统', uri: '', childs: [
                {text: '邮件模板', uri: '/mss/mail_template_list'},
                {text: '消息设置', uri: '/mss/mss_setting'},
            ]}
            /*,
             {text: '信息设置', uri: '', childs: [
             {text: '设置公告', uri: 'pt/page/update?type=notice'},
             {text: '修改商家介绍', uri: 'pt/page/update?type=about'}
             ]}*/
        ]});
    };

    function getDate(dt) {
        var cmath = function (v) {
            return v < 10 ? '0' + v : v;
        };
        if (!dt) {
            dt = new Date();
        }
        var chWeekNames = ['日', '一', '二', '三', '四', '五', '六'];
        return cmath(dt.getFullYear()) + '年' + cmath(dt.getMonth() + 1) + '月' + cmath(dt.getDate()) + '日&nbsp;/&nbsp;周' +
                chWeekNames[dt.getDay()];
        /*+ '&nbsp;' + cmath(dt.getHours()) + ':' + cmath(dt.getMinutes()) + ':' + cmath(dt.getSeconds());*/
    };

    function winLoad(){
        jr.event.add(jr.$('btn_logout'), 'click', function () {
            if (confirm('请确认您已经操作完毕并做好数据保存工作！确定继续吗？')) {
                location.replace('/main/logout');
            }
        });

        FwTab.show(pageVar.firstTabName, pageVar.firstIframeUrl, false);

        //下拉菜单事件注册
        var menuLis = document.getElementsByClassName('icon-ctrl')[0].getElementsByTagName('LI');
        jr.each(menuLis, function (i, e) {
            if (e.className.indexOf('drop') != -1) {
                jr.hover(e);
            }
        });

        _resizeWin();
    }
</script>

</body>
</html>
