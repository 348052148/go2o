<!doctype html>
<html>
<head>
	<title>查看订单</title>
    <link href="{{.Var.static_serve}}/assets/mui/css/latest/page_style.css?v={{.Var.version}}" rel="stylesheet" type="text/css" />
    <link href="{{.Var.static_serve}}/css/partner/partner.css?spam={{.Var.spam}}" rel="stylesheet" type="text/css" />
	<style type="text/css">
        body{margin:10px;}
		div.metainfo{position:relative;}
		div.metainfo p{width:200px;}
		div.metainfo .item{position:absolute;top:0;right:10px;z-index:10;padding:5px 10px;}
        div.metainfo .details{border:solid 1px #FFCC33;background:#FFFFDD;padding:5px;}
		p span.label{width:100px;display:block;float:left;}
        dl{clear:both;line-height:22px;border-bottom:solid 1px #ddd;margin:0;border-top:solid 1px #f5f5f5;}
        dl dt{width:100px;float:left;}
        div.order-info{width:300px;border:solid 1px #ddd;}
        .control{margin:20px 0;}
	</style>
</head>
<body>

<div id="form1">
	<h3>订单信息</h3>
	<div class="metainfo">
	<div class="item">
        <div class="details">
            <b>订单详情：</b><br />
            <p field="itemsInfo">-</p>
        </div>

        <p style="border:solid 1px #e5e5e5;padding:5px;background:#f8f8f8">
            <b>会员信息：</b><br/>
            姓名:{{.Map.member.Name}}
            (帐号：{{.Map.member.Usr}})<br/>
            电话:{{.Map.member.Phone}}<br />
            收货地址：{{.Map.member.Address}}<br />
        </p>

        <p style="border:solid 1px #e5e5e5;padding:5px;background:#f8f8f8">
            <b>配送信息：</b><br/>
            姓名:<span field="deliverName"></span><br/>
            电话:<span field="deliverPhone"></span><br />
            收货地址：<span field="deliverAddress"></span><br />
        </p>


    </div>


    <div class="order-info">
        <dl>
            <dt>订单号：</dt>
            <dd field="orderNo"></dd>
        </dl>

        <dl>
            <dt>订单总额：</dt>
            <dd>￥<span field="totalFee"></span></dd>
        </dl>

        <dl>
            <dt>订单金额：</dt>
            <dd>￥<span field="fee"></span></dd>
        </dl>
        <dl>
            <dt>优惠金额：</dt>
            <dd>￥<strong style="color:gold" field="discountFee"></strong></dd>
        </dl>
        <dl>
            <dt>应付金额：</dt>
            <dd>￥<strong style="color:green" field="payFee"></strong></dd>
        </dl>


        <dl>
            <dt>付款方式：</dt>
            <dd>{{.Map.payment}}</dd>
        </dl>

        <dl>
            <dt>订单状态：</dt>
            <dd>{{.Map.state}}</dd>
        </dl>

        <dl>
            <dt>配送分店：</dt>
            <dd>{{.Map.shopName}}</dd>
        </dl>


        <dl>
            <dt>订单备注：</dt>
            <dd><div field="note"></div></dd>
        </dl>

    </div>

    <div id="pl" class="control"></div>
    </div>
</div>

<script src="{{.Var.static_serve}}/assets/js/core_full.js?spam={{.Var.spam}}"></script>
<script src="{{.Var.static_serve}}/assets/js/plugins/sys.js?spam={{.Var.spam}}"></script>

	<script type="text/javascript">
          var entity ={{.Map.entity}} ||{};
          entity.itemsInfo = itemFmt(jr.toJson(entity.itemsInfo));
          jr.json.bind('form1', entity);
          jr.load('pl','setup?order_no='+jr.request('order_no'));
          function refresh(){
            var d = jr.dialog.getDialog();
            if(d){
                d.window.refresh();
            }
          }

          function itemFmt(items){
              var html = "";
              var tpl = '<img src="{img}" width="40" height="40" style="border:solid 1px #ddd;padding:1px;margin-right:3px;" title="{name} x {qty}"/>';
              for(var i=0;i<items.length;i++){
                  if(items[i].img.indexOf("http") != 0){
                      items[i].img = "{{.Var.img_serve}}/"+items[i].img;
                  }
                  html += jr.template(tpl,items[i]);
              }
              return html;
          }
	</script>
</body>
</html>
